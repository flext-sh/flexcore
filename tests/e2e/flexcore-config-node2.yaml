# FlexCore Node 2 Configuration for E2E Testing

# Windmill configuration
windmill:
  url: "http://windmill-server:8000"
  token: "test-token"
  workspace: "demo"

# Cluster configuration  
cluster:
  name: "test-cluster"
  node_id: "node-2"
  nodes:
    - "node-1"
    - "node-2"

# Event routes
event_routes:
  - name: "test-data-pipeline-secondary"
    source_adapter: "postgres-extractor"
    target_adapters: 
      - "json-transformer"
      - "api-loader"
    event_filter:
      event_types: ["data.extracted"]
    async: true
    max_retries: 3

  - name: "cross-node-response"
    source_adapter: "*"
    target_adapters: ["node-1"]
    event_filter:
      event_types: ["cross.node.response"]
    async: true

# Message queues
message_queues:
  - name: "test-queue-node2"
    type: "fifo"
    max_size: 1000
    ttl: "1h"

  - name: "delayed-queue"
    type: "delayed"
    max_size: 200
    ttl: "2h"

# Schedulers
schedulers:
  - name: "test-scheduler-secondary"
    cron_expression: "30 */1 * * * *"  # Every minute at 30 seconds
    workflow_path: "test/scheduled_job_secondary"
    singleton: false
    max_instances: 2
    input:
      test: true
      node: "node-2"

# Plugin configuration
plugins:
  directory: "/app/plugins"
  enabled:
    - "postgres-extractor"
    - "json-transformer"
    - "api-loader"

# Performance settings
performance:
  max_concurrent_jobs: 8
  event_buffer_size: 800
  
# Retry policy
retry_policy:
  max_retries: 3
  initial_delay: "1s"
  max_delay: "1m"
  backoff_factor: 2.0

# Logging
logging:
  level: "debug"
  format: "json"

# Custom parameters
custom_params:
  test_mode: true
  environment: "e2e-testing"
  node_role: "secondary"